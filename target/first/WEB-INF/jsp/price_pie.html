<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script type="text/javascript" src="assets/echarts/echarts.js"></script>
    <script type="text/javascript" src="assets/echarts/map/china.js"></script>
    <script type="text/javascript" src="assets/js/jquery.js"></script>
</head>
<body>
    <div id="container" style="height: 400px;width: 400px;"></div>
    <script>
        function loadPie(){
            var Chart = echarts.init(document.getElementById('container'));
            Chart.setOption({
                title : {
                    text: '准点率分布',
                    x:'center'
                },
                tooltip : {
                    trigger: 'item',
                    formatter: "{a} <br/>{b} : {c} ({d}%)"
                },
                legend: {
                    x : 'center',
                    y : 'bottom',
                    data:["50-60%","60-70%","70-80%","80-90%","90-100%"]
                },
                toolbox: {
                    show : true,
                    feature : {
                        mark : {show: true},
                        dataView : {show: true, readOnly: false},
                        magicType : {
                            show: true,
                            type: ['pie', 'funnel']
                        },
                        restore : {show: true},
                        saveAsImage : {show: true}
                    }
                },
                calculable : true,
                series : [
                    {
                        type:'pie',
                        radius : [20, 110],
                        center : ['50%', '60%'],
                        roseType : 'radius',
                        label: {
                            normal: {
                                show: false
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        lableLine: {
                            normal: {
                                show: false
                            },
                            emphasis: {
                                show: true
                            }
                        },
                        data:[]
            }]
        });
            Chart.showLoading();
            var counts=[];
            var nums=[];
            var names=["50-60%","60-70%","70-80%","80-90%","90-100%"];
            var brower=[];
            counts[0]=0;//50=60
            counts[1]=0;//60-70
            counts[2]=0;//70-80
            counts[3]=0;//80-90
            counts[4]=0;//90-100
            $.ajax({
                type:'get',
                url:'assets/price.json',
                dataType:'json',
                success:function (result) {
                    $.each(result.list,function (index,item) {
                        nums.push(item.onTime.substring(0,item.onTime.length-1));
                    });
                    for(var i=0;i<nums.length;i++){
                        if(nums[i]<60 && nums[i]>=50){
                            counts[0]++;
                        }
                        else if(nums[i]<70 && nums[i]>=60){
                            counts[1]++;
                        }
                        else if(nums[i]<80 && nums[i]>=70){
                            counts[2]++;
                        }
                        else if(nums[i]<90 && nums[i]>=80){
                            counts[3]++;
                        }
                        else if(nums[i]<100 && nums[i]>=90){
                            counts[4]++;
                        }
                    }
                    brower.push({
                        value:counts,
                        name:names
                    });
                    console.log(nums);
                    console.log(names[0]);
                    Chart.hideLoading();
                    Chart.setOption({
                        legend:{
                            data:names
                        },
                        series:[{
                            data:[
                                {value:counts[0], name:names[0]},
                                {value:counts[1], name:names[1]},
                                {value:counts[2], name:names[2]},
                                {value:counts[3], name:names[3]},
                                {value:counts[4], name:names[4]}
                            ],
                        }]
                    });

                },
                error:function (errorMsg) {
                    alert("图表请求数据失败！");
                    Chart.hideLoading();
                }

            });
        }
        loadPie();

    </script>
</body>
</html>